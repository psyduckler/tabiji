<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-D7QHNRXLHJ"></script>
    <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-D7QHNRXLHJ');
    </script>
    <link rel="icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><title>Plan Your Trip ‚Äî tabiji.ai</title>
    <meta name="description" content="Tell us about your dream trip and we'll craft a personalized itinerary from real traveler intel.">
    <style>
        :root {
            --indigo: #2D3A5C;
            --indigo-light: #3D4E7A;
            --warm-cream: #F5F0E8;
            --sand: #E8DFD0;
            --earth: #8B7355;
            --earth-light: #A6906F;
            --terracotta: #C4704B;
            --deep-brown: #3E2F23;
            --sage: #7A8B6F;
            --white: #FEFCF9;
            --text: #2C2419;
            --text-muted: #6B5D4F;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
            color: var(--text); background: var(--white); line-height: 1.6;
            -webkit-font-smoothing: antialiased;
        }
        nav {
            position: fixed; top: 0; width: 100%; z-index: 100;
            background: rgba(254, 252, 249, 0.92);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid var(--sand);
            padding: 1rem 2rem;
            display: flex; justify-content: space-between; align-items: center;
        }
        .logo {
            font-size: 1.4rem; font-weight: 700; color: var(--indigo);
            text-decoration: none; letter-spacing: -0.02em;
        }
        .logo span { color: var(--terracotta); }
        nav .nav-step {
            font-size: 0.85rem; color: var(--text-muted); font-weight: 500;
        }

        .form-hero {
            padding: 7rem 2rem 2rem; max-width: 640px; margin: 0 auto; text-align: center;
        }
        .form-hero h1 {
            font-size: clamp(1.8rem, 4vw, 2.4rem); font-weight: 800;
            color: var(--indigo); margin-bottom: 0.5rem; letter-spacing: -0.03em;
        }
        .form-hero p {
            font-size: 1.05rem; color: var(--text-muted); max-width: 480px; margin: 0 auto;
        }

        .form-container {
            max-width: 640px; margin: 2rem auto 4rem; padding: 0 2rem;
        }

        .field { margin-bottom: 2rem; }
        .field label {
            display: block; font-size: 0.95rem; font-weight: 600;
            color: var(--indigo); margin-bottom: 0.4rem;
        }
        .field .hint {
            font-size: 0.8rem; color: var(--text-muted); margin-bottom: 0.5rem;
        }
        .field input[type="text"],
        .field input[type="email"],
        .field input[type="date"],
        .field select,
        .field textarea {
            width: 100%; padding: 0.8rem 1rem; border-radius: 10px;
            border: 2px solid var(--sand); font-size: 1rem;
            background: var(--white); color: var(--text);
            font-family: inherit; outline: none; transition: border 0.2s;
            box-sizing: border-box;
        }
        .field input[type="date"] {
            -webkit-appearance: none; appearance: none;
            min-height: 0;
        }
        .field input:focus, .field select:focus, .field textarea:focus {
            border-color: var(--indigo);
        }
        .field textarea { resize: vertical; min-height: 80px; }

        .date-row { display: flex; gap: 1rem; width: 100%; overflow: hidden; }
        .date-row > div { flex: 1; min-width: 0; }

        .pill { display: inline-block; }
        .pill input { display: none; }
        .pill span {
            display: inline-block; padding: 0.5rem 1rem; border-radius: 100px;
            background: var(--warm-cream); border: 2px solid transparent;
            font-size: 0.9rem; color: var(--text); cursor: pointer;
            transition: border 0.2s, background 0.2s; user-select: none;
        }
        .pill input:checked + span {
            border-color: var(--terracotta); background: #FEF0E7; color: var(--terracotta);
        }
        .pill span:hover { border-color: var(--sand); }

        .divider {
            border: none; border-top: 1px solid var(--sand);
            margin: 2.5rem 0;
        }

        /* Accordion styles */
        .accordion {
            border: 2px solid var(--sand); border-radius: 12px;
            margin-bottom: 0.75rem; overflow: hidden;
            transition: border-color 0.2s;
        }
        .accordion.open { border-color: var(--earth-light); }
        .accordion-header {
            display: flex; align-items: center; justify-content: space-between;
            padding: 0.9rem 1.1rem; cursor: pointer; user-select: none;
            background: var(--warm-cream); transition: background 0.2s;
        }
        .accordion-header:hover { background: var(--sand); }
        .accordion-header .acc-title {
            font-size: 0.95rem; font-weight: 600; color: var(--indigo);
        }
        .accordion-header .acc-subtitle {
            font-size: 0.8rem; color: var(--text-muted); font-weight: 400;
            margin-left: 0.5rem;
        }
        .accordion-header .acc-chevron {
            font-size: 1rem; color: var(--text-muted); transition: transform 0.25s;
            flex-shrink: 0; margin-left: 0.75rem;
        }
        .accordion.open .acc-chevron { transform: rotate(180deg); }
        .accordion-body {
            max-height: 0; overflow: hidden; transition: max-height 0.3s ease, padding 0.3s ease;
            padding: 0 1.1rem;
        }
        .accordion.open .accordion-body {
            max-height: 400px; padding: 0.75rem 1.1rem 1.1rem;
        }
        .accordion-body .hint {
            font-size: 0.8rem; color: var(--text-muted); margin-bottom: 0.5rem;
        }

        .optional-section-label {
            font-size: 0.85rem; font-weight: 600; color: var(--text-muted);
            text-transform: uppercase; letter-spacing: 0.06em;
            margin-bottom: 0.75rem;
        }

        .submit-btn {
            display: block; width: 100%;
            background: var(--terracotta); color: white;
            padding: 1rem; border-radius: 10px; border: none;
            font-size: 1.1rem; font-weight: 600; cursor: pointer;
            box-shadow: 0 4px 14px rgba(196, 112, 75, 0.3);
            transition: transform 0.15s, box-shadow 0.15s;
            font-family: inherit;
        }
        .submit-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(196, 112, 75, 0.4);
        }
        .submit-btn:disabled {
            opacity: 0.7; cursor: not-allowed; transform: none;
        }
        .submit-sub {
            text-align: center; margin-top: 0.75rem;
            font-size: 0.85rem; color: var(--text-muted);
        }

        footer {
            padding: 3rem 2rem; text-align: center;
            border-top: 1px solid var(--sand);
            color: var(--text-muted); font-size: 0.85rem;
        }

        html, body { overflow-x: hidden; }
        input, select, textarea { max-width: 100%; box-sizing: border-box; }
        @media (max-width: 600px) {
            nav { padding: 0.8rem 1.2rem; }
            .form-hero { padding: 6rem 1.5rem 1.5rem; }
            .form-container { padding: 0 1.5rem; }
            .date-row { flex-direction: column; gap: 0.75rem; }
        }
    </style>
</head>
<body>

<nav>
    <a href="/" class="logo"><img src="/logo-kanji-only.png" alt="tabiji.ai" style="height:32px;vertical-align:middle;margin-right:6px;">tabiji<span>.ai</span></a>
    <div class="nav-step">Step 1 of 2 ‚Äî Tell us about your trip</div>
</nav>

<div class="form-hero">
    <h1>Let's plan your perfect trip ‚úàÔ∏è</h1>
    <p>Just the basics ‚Äî or tell us everything. The more we know, the better your itinerary.</p>
</div>

<form class="form-container" id="intake-form" onsubmit="submitForm(event)">

    <!-- REQUIRED FIELDS -->
    <div class="field">
        <label for="destination">Where are you going?</label>
        <input type="text" id="destination" name="destination" placeholder="e.g. Tokyo, Japan" required autocomplete="off">
    </div>

    <div class="field">
        <label>When are you traveling?</label>
        <div class="date-row">
            <div>
                <input type="date" id="start_date" name="start_date" required placeholder="Start date" onchange="const ed=document.getElementById('end_date'); ed.min=this.value; if(ed.value && ed.value < this.value) ed.value=this.value;">
            </div>
            <div>
                <input type="date" id="end_date" name="end_date" required placeholder="End date">
            </div>
        </div>
    </div>

    <div class="field">
        <label for="group_size">Group size</label>
        <select id="group_size" name="group_size" required>
            <option value="" disabled selected>How many travelers?</option>
            <option value="1">1 ‚Äî Solo</option>
            <option value="2">2 ‚Äî Couple / Duo</option>
            <option value="3-4">3‚Äì4</option>
            <option value="5+">5+</option>
        </select>
    </div>

    <div class="field">
        <label for="email">Email</label>
        <p class="hint">We'll deliver your itinerary here</p>
        <input type="email" id="email" name="email" placeholder="your@email.com" required>
    </div>

    <hr class="divider">

    <!-- OPTIONAL ACCORDIONS -->
    <p class="optional-section-label">Optional ‚Äî personalize your trip</p>

    <div class="accordion" data-accordion>
        <div class="accordion-header" onclick="toggleAccordion(this)">
            <div><span class="acc-title">ü•æ Travel style</span><span class="acc-subtitle">Adventure, cultural, foodie‚Ä¶</span></div>
            <span class="acc-chevron">‚ñæ</span>
        </div>
        <div class="accordion-body">
            <p class="hint">Pick all that apply</p>
            <div style="display:flex;flex-wrap:wrap;gap:0.5rem;">
                <label class="pill"><input type="checkbox" name="style" value="Adventure"><span>ü•æ Adventure</span></label>
                <label class="pill"><input type="checkbox" name="style" value="Cultural"><span>üèõÔ∏è Cultural</span></label>
                <label class="pill"><input type="checkbox" name="style" value="Foodie"><span>üçú Foodie</span></label>
                <label class="pill"><input type="checkbox" name="style" value="Relaxation"><span>üßò Relaxation</span></label>
                <label class="pill"><input type="checkbox" name="style" value="Nightlife"><span>üç∏ Nightlife</span></label>
                <label class="pill"><input type="checkbox" name="style" value="Family-friendly"><span>üë®‚Äçüë©‚Äçüëß Family-friendly</span></label>
            </div>
        </div>
    </div>

    <div class="accordion" data-accordion>
        <div class="accordion-header" onclick="toggleAccordion(this)">
            <div><span class="acc-title">üçΩÔ∏è Dining preferences</span><span class="acc-subtitle">Fine dining, casual, mix‚Ä¶</span></div>
            <span class="acc-chevron">‚ñæ</span>
        </div>
        <div class="accordion-body">
            <div style="display:flex;flex-wrap:wrap;gap:0.5rem;">
                <label class="pill"><input type="radio" name="dining" value="Fine dining all meals"><span>Fine dining for all meals</span></label>
                <label class="pill"><input type="radio" name="dining" value="Fine dining dinners only"><span>Fine dining dinners only</span></label>
                <label class="pill"><input type="radio" name="dining" value="Casual throughout"><span>Casual throughout</span></label>
                <label class="pill"><input type="radio" name="dining" value="Mix of everything"><span>Mix of everything</span></label>
            </div>
        </div>
    </div>

    <div class="accordion" data-accordion>
        <div class="accordion-header" onclick="toggleAccordion(this)">
            <div><span class="acc-title">üí∞ Budget per person</span><span class="acc-subtitle">Helps us tailor recommendations</span></div>
            <span class="acc-chevron">‚ñæ</span>
        </div>
        <div class="accordion-body">
            <select id="budget" name="budget" style="width:100%;padding:0.8rem 1rem;border-radius:10px;border:2px solid var(--sand);font-size:1rem;background:var(--white);color:var(--text);font-family:inherit;outline:none;">
                <option value="" disabled selected>Select a range</option>
                <option value="Under $1,000">Under $1,000</option>
                <option value="$1,000-2,000">$1,000‚Äì$2,000</option>
                <option value="$2,000-5,000">$2,000‚Äì$5,000</option>
                <option value="$5,000-10,000">$5,000‚Äì$10,000</option>
                <option value="$10,000+">$10,000+</option>
                <option value="Surprise me">Surprise me üéâ</option>
            </select>
        </div>
    </div>

    <div class="accordion" data-accordion>
        <div class="accordion-header" onclick="toggleAccordion(this)">
            <div><span class="acc-title">‚ú® Anything else?</span><span class="acc-subtitle">Special requests, must-sees, vibes‚Ä¶</span></div>
            <span class="acc-chevron">‚ñæ</span>
        </div>
        <div class="accordion-body">
            <textarea id="requests" name="requests" placeholder="e.g. We love hole-in-the-wall ramen joints. Partner is vegetarian. Want at least one onsen day." style="width:100%;padding:0.8rem 1rem;border-radius:10px;border:2px solid var(--sand);font-size:1rem;background:var(--white);color:var(--text);font-family:inherit;outline:none;resize:vertical;min-height:80px;"></textarea>
        </div>
    </div>

    <div style="margin-top: 2rem;">
        <button type="submit" class="submit-btn" id="submit-btn">Get Your Free Custom Itinerary</button>
        <p class="submit-sub">We'll craft your personalized itinerary and email it to you within 10 minutes.</p>
    </div>

</form>

<footer>
    <p>¬© 2026 tabiji.ai. All rights reserved.</p>
</footer>

<script>
// Pre-fill destination from URL param
(function() {
    const params = new URLSearchParams(window.location.search);
    const dest = params.get('destination');
    if (dest) {
        const el = document.getElementById('destination');
        if (el) el.value = dest;
    }
})();

function toggleAccordion(header) {
    const accordion = header.closest('.accordion');
    accordion.classList.toggle('open');
}

async function submitForm(e) {
    e.preventDefault();
    const btn = document.getElementById('submit-btn');
    btn.textContent = 'Submitting‚Ä¶';
    btn.disabled = true;

    const form = document.getElementById('intake-form');
    const styles = Array.from(form.querySelectorAll('input[name="style"]:checked')).map(c => c.value);
    const diningEl = form.querySelector('input[name="dining"]:checked');
    const dining = diningEl ? diningEl.value : '';
    const budgetEl = document.getElementById('budget');
    const budget = budgetEl ? budgetEl.value : '';

    const payload = {
        destination: form.destination.value,
        start_date: form.start_date.value,
        end_date: form.end_date.value,
        group_size: form.group_size.value,
        travel_style: styles.join(', '),
        dining: dining,
        budget: budget,
        requests: form.requests.value,
        email: form.email.value,
    };

    try {
        const res = await fetch('https://webhook.tabiji.ai/order', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(payload),
        });
        const data = await res.json();
        if (data.ok) {
            window.location.href = '/success.html';
        } else {
            alert('Something went wrong. Please try again.');
            btn.textContent = 'Get Your Free Custom Itinerary';
            btn.disabled = false;
        }
    } catch (err) {
        alert('Something went wrong. Please try again.');
        btn.textContent = 'Get Your Free Custom Itinerary';
        btn.disabled = false;
    }
}
</script>

<script>
(g=>{var h,a,k,p="The Google Maps JavaScript API",c="google",l="importLibrary",q="__ib__",m=document,b=window;b=b[c]||(b[c]={});var d=b.maps||(b.maps={}),r=new Set,e=new URLSearchParams,u=()=>h||(h=new Promise(async(f,n)=>{await (a=m.createElement("script"));e.set("libraries",[...r]);for(k in g)e.set(k.replace(/[A-Z]/g,t=>"_"+t[0].toLowerCase()),g[k]);e.set("callback",c+".maps."+q);a.src=`https://maps.googleapis.com/maps/api/js?`+e;d[q]=f;a.onerror=()=>h=n(Error(p+" could not load."));a.nonce=m.querySelector("script[nonce]")?.nonce||"";m.head.append(a)}));d[l]?console.warn(p+" only loads once."):d[l]=(f,...n)=>r.add(f)&&u().then(()=>d[l](f,...n))})({
  key: "AIzaSyBP0yidMjJEECgkIiZz2lw1NLsQ7jdASYc",
  v: "weekly"
});

async function initAutocomplete() {
    const { Place } = await google.maps.importLibrary("places");
    const input = document.getElementById('destination');

    let debounceTimer;
    const dropdown = document.createElement('div');
    dropdown.className = 'autocomplete-dropdown';
    dropdown.style.cssText = 'position:absolute;z-index:1000;background:#fff;border:1px solid #ddd;border-radius:8px;box-shadow:0 4px 12px rgba(0,0,0,.15);max-height:240px;overflow-y:auto;display:none;width:100%;left:0;top:100%;';
    input.parentElement.style.position = 'relative';
    input.parentElement.appendChild(dropdown);

    input.addEventListener('input', function() {
        clearTimeout(debounceTimer);
        const val = this.value.trim();
        if (val.length < 2) { dropdown.style.display = 'none'; return; }
        debounceTimer = setTimeout(async () => {
            try {
                const { AutocompleteSuggestion } = await google.maps.importLibrary("places");
                const response = await AutocompleteSuggestion.fetchAutocompleteSuggestions({
                    input: val,
                    includedPrimaryTypes: ['locality'],
                });
                dropdown.innerHTML = '';
                if (response.suggestions.length === 0) { dropdown.style.display = 'none'; return; }
                response.suggestions.forEach(s => {
                    const pred = s.placePrediction;
                    if (!pred) return;
                    const item = document.createElement('div');
                    item.style.cssText = 'padding:10px 14px;cursor:pointer;font-size:14px;border-bottom:1px solid #f0f0f0;';
                    item.textContent = pred.text.toString();
                    item.addEventListener('mousedown', (e) => {
                        e.preventDefault();
                        input.value = pred.text.toString();
                        dropdown.style.display = 'none';
                    });
                    item.addEventListener('mouseenter', () => item.style.background = '#f5f5f5');
                    item.addEventListener('mouseleave', () => item.style.background = '#fff');
                    dropdown.appendChild(item);
                });
                dropdown.style.display = 'block';
            } catch (err) {
                console.error('Autocomplete error:', err);
                dropdown.style.display = 'none';
            }
        }, 300);
    });

    input.addEventListener('blur', () => setTimeout(() => dropdown.style.display = 'none', 200));
    document.addEventListener('click', (e) => { if (!input.parentElement.contains(e.target)) dropdown.style.display = 'none'; });
}

initAutocomplete();
</script>
</body>
</html>
