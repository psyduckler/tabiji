<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Find Your Perfect Destination | tabiji.ai</title>
<meta name="description" content="Filter hundreds of destinations by budget, style, and continent. Find your next trip in seconds.">
<meta property="og:title" content="Find Your Perfect Destination | tabiji.ai">
<meta property="og:description" content="Filter hundreds of destinations by budget, style, and continent.">
<meta property="og:url" content="https://tabiji.ai/find/">
<meta property="og:type" content="website">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700;900&family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
<style>
:root{--indigo:#1a365d;--terracotta:#c4704b;--cream:#faf6f1;--sand:#e8ddd3;--dark:#1a1a1a;--light-text:#6b5c4d;--green:#3a7d5c}
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:'Inter',sans-serif;background:var(--cream);color:var(--dark);min-height:100vh}
.header{text-align:center;padding:32px 20px 0}
.brand{font-family:'Playfair Display',serif;color:var(--terracotta);font-weight:700;font-size:1rem}
h1{font-family:'Playfair Display',serif;font-size:clamp(1.8rem,5vw,2.8rem);color:var(--indigo);margin:10px 0 4px;line-height:1.15}
.subtitle{color:var(--light-text);font-size:0.95rem}
.filters{max-width:680px;margin:32px auto;padding:0 20px}
.filter-section{margin-bottom:20px}
.filter-section label{display:block;font-size:0.78rem;font-weight:600;color:var(--light-text);text-transform:uppercase;letter-spacing:0.5px;margin-bottom:8px}
.chips{display:flex;flex-wrap:wrap;gap:8px}
.chip{padding:8px 16px;border-radius:50px;border:2px solid var(--sand);background:#fff;font-size:0.88rem;font-weight:500;cursor:pointer;transition:all .15s;font-family:'Inter',sans-serif;color:var(--dark);user-select:none}
.chip:hover{border-color:var(--indigo);background:#f0f4fa}
.chip.active{background:var(--indigo);color:#fff;border-color:var(--indigo)}
.chip.active:hover{background:#2a4a7a;border-color:#2a4a7a}
.filter-actions{display:flex;gap:12px;justify-content:center;margin-top:28px;align-items:center}
.find-btn{background:var(--indigo);color:#fff;border:none;padding:16px 52px;border-radius:50px;font-size:1.1rem;font-weight:600;cursor:pointer;transition:all .2s;font-family:'Inter',sans-serif}
.find-btn:hover{transform:translateY(-2px);box-shadow:0 8px 24px rgba(26,54,93,.25)}
.find-btn:active{transform:translateY(0)}
.clear-btn{background:none;border:none;color:var(--terracotta);font-size:0.9rem;font-weight:600;cursor:pointer;font-family:'Inter',sans-serif}
.clear-btn:hover{text-decoration:underline}
.results-section{display:none}
.results-section.show{display:block}
.results-bar{max-width:720px;margin:0 auto;padding:8px 20px;display:flex;justify-content:space-between;align-items:center}
.results-count{font-size:0.9rem;color:var(--light-text)}
.shuffle-btn{background:none;border:none;color:var(--indigo);font-weight:600;font-size:0.85rem;cursor:pointer;font-family:'Inter',sans-serif}
.shuffle-btn:hover{text-decoration:underline}
.grid{max-width:720px;margin:0 auto 20px;padding:0 20px;display:grid;grid-template-columns:repeat(auto-fill,minmax(320px,1fr));gap:20px}
.card{background:#fff;border-radius:16px;overflow:hidden;box-shadow:0 4px 20px rgba(0,0,0,.07);transition:transform .2s,box-shadow .2s;cursor:pointer;animation:fadeUp .4s ease both}
.card:hover{transform:translateY(-4px);box-shadow:0 8px 32px rgba(0,0,0,.12)}
@keyframes fadeUp{from{opacity:0;transform:translateY(16px)}to{opacity:1;transform:translateY(0)}}
.card img{width:100%;height:200px;object-fit:cover}
.card-body{padding:16px 20px 20px}
.card-body h2{font-family:'Playfair Display',serif;font-size:1.25rem;color:var(--indigo);margin-bottom:2px}
.card-body .region{color:var(--light-text);font-size:0.8rem;margin-bottom:10px}
.card-body .pitch{font-size:0.9rem;line-height:1.55;color:#444;margin-bottom:12px;height:54px;overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-line-clamp:3;-webkit-box-orient:vertical}
.tags{display:flex;flex-wrap:wrap;gap:6px;margin-bottom:12px}
.tag{padding:4px 10px;border-radius:16px;font-size:0.72rem;font-weight:600}
.tag.vibe{background:#eef2ff;color:var(--indigo)}
.tag.budget{background:#fef3ee;color:var(--terracotta)}
.card-meta{display:flex;gap:14px;font-size:0.8rem;color:var(--light-text)}
.empty{text-align:center;padding:60px 20px;max-width:720px;margin:0 auto}
.empty h2{font-family:'Playfair Display',serif;color:var(--indigo);font-size:1.5rem;margin-bottom:8px}
.empty p{color:var(--light-text)}
.load-more-wrap{text-align:center;margin:20px 0 60px}
.load-more-btn{background:var(--sand);color:var(--indigo);border:none;padding:14px 40px;border-radius:50px;font-size:0.9rem;font-weight:600;cursor:pointer;transition:all .2s;font-family:'Inter',sans-serif}
.load-more-btn:hover{background:#dccfc4}
.modal-overlay{display:none;position:fixed;inset:0;background:rgba(0,0,0,.5);z-index:100;align-items:center;justify-content:center;padding:20px}
.modal-overlay.show{display:flex}
.modal{background:#fff;border-radius:20px;max-width:500px;width:100%;max-height:90vh;overflow-y:auto;position:relative}
.modal img{width:100%;height:280px;object-fit:cover;border-radius:20px 20px 0 0}
.modal .card-body{padding:24px}
.modal .card-body h2{font-size:1.5rem}
.modal-close{position:absolute;top:12px;right:12px;width:36px;height:36px;border-radius:50%;background:rgba(0,0,0,.5);border:none;color:#fff;font-size:1.2rem;cursor:pointer;display:flex;align-items:center;justify-content:center}
.card-cta{display:inline-block;margin-top:12px;padding:8px 20px;border-radius:50px;background:var(--indigo);color:#fff;text-decoration:none;font-size:0.85rem;font-weight:600;transition:all .2s}
.card-cta:hover{background:#2a4a7a}
@media(max-width:480px){.grid{grid-template-columns:1fr}}
</style>
</head>
<body>

<div class="header">
  <div class="brand">tabiji.ai</div>
  <h1>Find Your Perfect Destination</h1>
  <p class="subtitle">Pick what matters to you. We'll do the rest.</p>
</div>

<div class="filters">
  <div class="filter-section">
    <label>Budget</label>
    <div class="chips" id="budgetChips">
      <button class="chip" data-value="$">$ Budget</button>
      <button class="chip" data-value="$$">$$ Mid-range</button>
      <button class="chip" data-value="$$$">$$$ Premium</button>
      <button class="chip" data-value="$$$$">$$$$ Luxury</button>
    </div>
  </div>
  <div class="filter-section">
    <label>Trip Style</label>
    <div class="chips" id="tripChips">
      <button class="chip" data-value="Beach">üèñ Beach & Islands</button>
      <button class="chip" data-value="Adventure">üßó Adventure</button>
      <button class="chip" data-value="Culture">üèõ Culture & History</button>
      <button class="chip" data-value="Food">üçú Food & Culinary</button>
      <button class="chip" data-value="Romance">üíï Romance</button>
      <button class="chip" data-value="Nightlife">üé∂ Nightlife</button>
      <button class="chip" data-value="Wellness">üßò Wellness</button>
      <button class="chip" data-value="Wildlife">ü¶Å Wildlife & Safari</button>
      <button class="chip" data-value="Nature">üåø Nature</button>
      <button class="chip" data-value="Hiking">ü•æ Hiking</button>
      <button class="chip" data-value="Photography">üì∏ Photography</button>
    </div>
  </div>
  <div class="filter-section">
    <label>Travel Style</label>
    <div class="chips" id="travelChips">
      <button class="chip" data-value="solo">üéí Solo-friendly</button>
      <button class="chip" data-value="offbeat">üó∫ Off the beaten path</button>
      <button class="chip" data-value="luxury">‚ú® Luxury</button>
      <button class="chip" data-value="budget">üí∏ Budget backpacker</button>
    </div>
  </div>
  <div class="filter-section">
    <label>Continent</label>
    <div class="chips" id="continentChips">
      <button class="chip" data-value="Europe">Europe</button>
      <button class="chip" data-value="Asia">Asia</button>
      <button class="chip" data-value="Africa">Africa</button>
      <button class="chip" data-value="North America">North America</button>
      <button class="chip" data-value="South America">South America</button>
      <button class="chip" data-value="Oceania">Oceania</button>
      <button class="chip" data-value="Middle East">Middle East</button>
      <button class="chip" data-value="Polar">Polar & Arctic</button>
    </div>
  </div>
  <div class="filter-actions">
    <button class="find-btn" onclick="findDestinations()">Find Destinations ‚Üí</button>
    <button class="clear-btn" onclick="clearFilters()">Clear all</button>
  </div>
</div>

<div class="results-section" id="resultsSection">
  <div class="results-bar">
    <span class="results-count" id="resultsCount"></span>
    <button class="shuffle-btn" onclick="shuffleResults()">‚Üª Shuffle</button>
  </div>
  <div class="grid" id="grid"></div>
  <div class="load-more-wrap" id="loadMoreWrap" style="display:none;">
    <button class="load-more-btn" onclick="loadMore()">Load More</button>
  </div>
  <div class="empty" id="empty" style="display:none">
    <h2>No destinations match</h2>
    <p>Try loosening your filters ‚Äî or embrace the unexpected.</p>
  </div>
</div>

<div class="modal-overlay" id="modal" onclick="if(event.target===this)closeModal()">
  <div class="modal">
    <button class="modal-close" onclick="closeModal()">‚úï</button>
    <img id="mImg" src="" alt="">
    <div class="card-body">
      <h2 id="mName"></h2><div class="region" id="mRegion"></div><p class="pitch" id="mPitch"></p><div class="tags" id="mTags"></div><div class="card-meta"><span id="mBudget"></span><span id="mSeason"></span></div><a class="card-cta" id="mCta" href="#">Plan this trip ‚Üí</a>
    </div>
  </div>
</div>

<script>
let allDestinations = [];
let filtered = [];
let currentlyVisible = 0;
const PER_PAGE = 18;

// State
let selectedBudget = [];
let selectedTrip = [];
let selectedTravel = [];
let selectedContinent = [];

function setupChips(containerId, stateArr, multiSelect) {
  const container = document.getElementById(containerId);
  container.querySelectorAll('.chip').forEach(chip => {
    chip.addEventListener('click', () => {
      const val = chip.dataset.value;
      if (multiSelect) {
        chip.classList.toggle('active');
        const idx = stateArr.indexOf(val);
        if (idx >= 0) stateArr.splice(idx, 1);
        else stateArr.push(val);
      } else {
        const wasActive = chip.classList.contains('active');
        container.querySelectorAll('.chip').forEach(c => c.classList.remove('active'));
        stateArr.length = 0;
        if (!wasActive) {
          chip.classList.add('active');
          stateArr.push(val);
        }
      }
    });
  });
}

function shuffle(arr) {
  for (let i = arr.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [arr[i], arr[j]] = [arr[j], arr[i]];
  }
  return arr;
}

function findDestinations() {
  filtered = allDestinations.filter(d => {
    if (selectedBudget.length && !selectedBudget.includes(d.budget)) return false;
    if (selectedTrip.length && !selectedTrip.some(t => (d.vibes || []).some(v => v.toLowerCase().includes(t.toLowerCase())))) return false;
    if (selectedTravel.length && !selectedTravel.some(t => (d.travel || []).includes(t))) return false;
    if (selectedContinent.length && !selectedContinent.includes(d.continent)) return false;
    return true;
  });
  shuffle(filtered);
  document.getElementById('resultsSection').classList.add('show');
  currentlyVisible = 0;
  render(true);
  document.getElementById('resultsSection').scrollIntoView({ behavior: 'smooth' });
}

function clearFilters() {
  selectedBudget.length=0; selectedTrip.length=0; selectedTravel.length=0; selectedContinent.length=0;
  document.querySelectorAll('.chip.active').forEach(c => c.classList.remove('active'));
  document.getElementById('resultsSection').classList.remove('show');
}

function shuffleResults() {
  shuffle(filtered);
  render(true);
}

function render(isNewFilter = false) {
  const grid = document.getElementById('grid');
  const empty = document.getElementById('empty');
  const loadMoreWrap = document.getElementById('loadMoreWrap');
  
  if (isNewFilter) {
    grid.innerHTML = '';
    currentlyVisible = 0;
  }
  
  document.getElementById('resultsCount').textContent = `${filtered.length} destination${filtered.length !== 1 ? 's' : ''} found`;

  if (filtered.length === 0) {
    empty.style.display = 'block';
    loadMoreWrap.style.display = 'none';
    return;
  }
  empty.style.display = 'none';

  const toShow = filtered.slice(currentlyVisible, currentlyVisible + PER_PAGE);
  const newCards = toShow.map((d, i) => {
    const indexInAll = allDestinations.indexOf(d);
    return `
    <div class="card" onclick="openModal(${indexInAll})" style="animation-delay:${(i * 0.05)}s">
      <img src="https://images.unsplash.com/photo-${d.photo}?w=600&q=80" alt="${d.name}" loading="lazy">
      <div class="card-body">
        <h2>${d.name}</h2>
        <div class="region">${d.region}</div>
        <p class="pitch">${d.pitch || ''}</p>
        <div class="tags">
          ${(d.vibes || []).map(v => `<span class="tag vibe">${v}</span>`).join('')}
          <span class="tag budget">${d.budget}</span>
        </div>
        <div class="card-meta"><span>üìÖ ${d.season}</span></div>
      </div>
    </div>`;
  }).join('');
  
  grid.insertAdjacentHTML('beforeend', newCards);
  currentlyVisible += toShow.length;

  if (currentlyVisible < filtered.length) {
    loadMoreWrap.style.display = 'block';
  } else {
    loadMoreWrap.style.display = 'none';
  }
}

function loadMore() {
  render();
}

function openModal(idx) {
  const d = allDestinations[idx];
  document.getElementById('mImg').src = `https://images.unsplash.com/photo-${d.photo}?w=800&q=80`;
  document.getElementById('mImg').alt = d.name;
  document.getElementById('mName').textContent = d.name;
  document.getElementById('mRegion').textContent = d.region;
  document.getElementById('mPitch').textContent = d.pitch || '';
  document.getElementById('mBudget').textContent = 'üí∞ ' + d.budget;
  document.getElementById('mSeason').textContent = 'üìÖ ' + d.season;
  document.getElementById('mTags').innerHTML = (d.vibes || []).map(v => `<span class="tag vibe">${v}</span>`).join('');
  const slug = d.name.toLowerCase().replace(/\\s+/g, '-');
  document.getElementById('mCta').href = `https://tabiji.ai/destinations/${slug}`;
  document.getElementById('modal').classList.add('show');
  document.body.style.overflow = 'hidden';
}

function closeModal() {
  document.getElementById('modal').classList.remove('show');
  document.body.style.overflow = '';
}

document.addEventListener('keydown', e => { if (e.key === 'Escape') closeModal(); });

async function init() {
  setupChips('budgetChips', selectedBudget, false);
  setupChips('tripChips', selectedTrip, true);
  setupChips('travelChips', selectedTravel, true);
  setupChips('continentChips', selectedContinent, true);
  
  try {
    const response = await fetch('destinations.json?v=2'); // Cache buster
    allDestinations = await response.json();
    document.getElementById('find-btn-text').textContent = `Find Destinations (${allDestinations.length} available)`;
  } catch (error) {
    console.error('Failed to load destinations:', error);
    document.querySelector('.filters').innerHTML = '<p style="text-align:center;color:red;">Error: Could not load destination data. Please try again later.</p>';
  }
}

init();
</script>
<!-- GA4 -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-D7QHNRXLHJ"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date());gtag('config','G-D7QHNRXLHJ');</script>
</body>
</html>
